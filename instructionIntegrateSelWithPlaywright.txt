Playwright (runner library)
Structure

bash
Copy
Edit
playwright/
  deps.edn
  src/playwright/function_test.clj
  src/playwright/test_harness.clj        ; if your harness lives here
  src/playwright/steps.clj               ; if your step fns live here
playwright/deps.edn

clojure
Copy
Edit
{:paths ["src"]}
playwright/src/playwright/function_test.clj

clojure
Copy
Edit
(ns playwright.function-test
  (:require
    [playwright.test-harness :as h]
    [playwright.steps :refer [download-flipbook-step make-upload-step]]))

;; Each element is one test (fn of mainState)
(def steps
  [;; 1
   (fn [mainState]
     (h/run-test! mainState "download-flipbook" download-flipbook-step))
   ;; 2
   (fn [mainState]
     (h/run-test! mainState "upload-owl"
                  (make-upload-step "owlBuddycloudinary.json")))
   ;; 3 ... add more
   ])

(defn functionTest
  "Arity-1: run ALL tests once in order.
   Arity-2: run the given 1-based positions in the SAME order (duplicates allowed)."
  ([mainState]
   (mapv #(% mainState) steps))
  ([mainState positions]
   (mapv (fn [pos]
           (if-let [step (nth steps (dec pos) nil)]
             (step mainState)
             {:position pos :ok false :error :no-such-test}))
         positions)))
If playwright.test-harness or your step fns currently live in sel, move them here or create thin facades under the playwright.* ns. Do not make playwright depend on sel.

Sel (GUI app)
Add dependency on playwright

Local (fastest while iterating)
sel/deps.edn:

clojure
Copy
Edit
{:deps {playwright/playwright {:local/root "../playwright"}}}
Git dep (when you publish it)
clojure
Copy
Edit
{:deps {playwright/playwright {:git/url "https://github.com/you/playwright.git"
                               :git/sha "abcdef1234567890"}}}
Call it from the GUI
sel/src/sel/run.clj:

clojure
Copy
Edit
(ns sel.run
  (:require [playwright.function-test :as ft]))

(defn run-selected
  "positions = nil → run all. Vector like [2 1 2] → run selected."
  [mainState positions]
  (if (seq positions)
    (ft/functionTest mainState positions)
    (ft/functionTest mainState)))
Usage from GUI code

clojure
Copy
Edit
(run-selected mainState nil)        ;; run all
(run-selected mainState [2 1 2])    ;; run selected in that order
Sanity checks
No circular deps (sel → playwright only).

playwright/deps.edn has :paths ["src"].

In sel, run clj -Stree to confirm playwright is on the classpath.

Keep namespaces consistent (playwright.*) and move shared code out of sel.